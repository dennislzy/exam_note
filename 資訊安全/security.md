# 資訊安全完整學習筆記

## 目錄
- [身份認證機制](#身份認證機制)
- [密碼學基礎](#密碼學基礎)
- [數位簽章與 PKI](#數位簽章與-pki)
- [網路安全協定](#網路安全協定)
- [虛擬私人網路 (VPN)](#虛擬私人網路-vpn)
- [常見網路攻擊](#常見網路攻擊)
- [Web 應用程式安全](#web-應用程式安全)
- [系統安全威脅](#系統安全威脅)
- [網路防護機制](#網路防護機制)
---

## 身份認證機制
[⬆️ 回到目錄](#目錄)

### 認證三要素

**你知道的東西 (Something You Know)**
- **密碼 (Password)**
- **PIN 碼**
- **安全問題答案**
- **圖形密碼**

**你擁有的東西 (Something You Have)**
- **手機 (SMS/App)**
- **硬體金鑰 (USB Token)**
- **智慧卡**
- **RFID 卡**

**你是什麼 (Something You Are)**
- **指紋識別**
- **虹膜掃描**
- **聲紋識別**
- **臉部識別**

### 多重認證方式

**兩步驟驗證 (Two-Step Verification)**
- **定義**：兩個連續的認證步驟
- **特性**：不強調認證類型的差異
- **例子**：密碼 + 簡訊驗證碼
- **安全性**：中等，比單一認證強

**雙重因子認證 (Two-Factor Authentication, 2FA)**
- **定義**：使用兩種不同類型的認證要素
- **要求**：必須來自不同的認證類別
- **例子**：
  - 密碼 + 手機 App 驗證碼
  - 指紋 + PIN 碼
  - 智慧卡 + 密碼
- **優點**：
  - 安全性顯著提升
  - 降低單點失效風險
  - 符合法規要求

**多步驟驗證 (Multi-Factor Authentication, MFA)**
- **定義**：使用三種或以上的認證要素
- **組合例子**：密碼 + 指紋 + 簡訊驗證碼
- **適用場景**：
  - 高度敏感系統
  - 金融交易
  - 政府機關
  - 醫療系統

### 傳統認證協定

**密碼認證協定 (Password Authentication Protocol, PAP)**
- **特性**：使用明文傳輸密碼
- **安全性**：極低，容易被竊聽
- **應用**：早期撥號連線 (已淘汰)

**挑戰握手認證協定 (Challenge Handshake Authentication Protocol, CHAP)**
- **工作原理**：
  1. 伺服器發送隨機挑戰值
  2. 客戶端用密碼和挑戰值計算雜湊
  3. 傳送雜湊值給伺服器驗證
- **優點**：不傳送明文密碼
- **應用**：撥號網路、PPP 連線

### 現代認證技術

**單一登入 (Single Sign-On, SSO)**
- **概念**：一次登入，多系統存取
- **優點**：
  - 使用者體驗佳
  - 減少密碼數量
  - 集中管理
- **缺點**：單點失效風險
- **技術**：SAML、OAuth、OpenID Connect

**OAuth 2.0**
- **用途**：授權框架，允許第三方應用存取資源
- **角色**：
  - 資源擁有者 (用戶)
  - 客戶端 (應用程式)
  - 授權伺服器
  - 資源伺服器
- **流程**：授權碼模式、隱式模式、客戶端憑證模式

---

## 密碼學基礎
[⬆️ 回到目錄](#目錄)

### 對稱式加密

**基本概念**
- **定義**：加密和解密使用相同金鑰
- **金鑰分享問題**：如何安全地分享金鑰

**優點**
- **處理速度快**：適合大量資料加密
- **計算資源需求低**：硬體實作容易
- **實作簡單**：演算法相對簡單

**缺點**
- **金鑰管理困難**：n 個用戶需要 n(n-1)/2 個金鑰
- **無法提供不可否認性**：雙方都有相同金鑰
- **金鑰分發問題**：如何安全傳送金鑰

**常見演算法**

**AES (Advanced Encryption Standard)**
- **金鑰長度**：128、192、256 位元
- **區塊大小**：128 位元
- **安全性**：目前最廣泛使用，安全性高
- **應用**：Wi-Fi WPA2/WPA3、VPN、檔案加密

**DES (Data Encryption Standard)**
- **金鑰長度**：56 位元
- **狀態**：已被破解，不建議使用
- **歷史意義**：早期標準加密演算法

**3DES (Triple DES)**
- **概念**：對 DES 進行三次加密
- **金鑰長度**：112 或 168 位元
- **狀態**：逐漸被 AES 取代

### 非對稱式加密

**基本概念**
- **定義**：加密和解密使用不同金鑰 (公鑰/私鑰)
- **金鑰對**：每個用戶有一對數學相關的金鑰

**工作原理**
```
Alice 要發送訊息給 Bob：
1. Alice 用 Bob 的公鑰加密訊息
2. 只有 Bob 的私鑰能解密
3. Bob 收到後用自己的私鑰解密
```

**優點**
- **解決金鑰分發問題**：公鑰可以公開
- **支援數位簽章**：提供不可否認性
- **適合身份驗證**：公鑰基礎建設

**缺點**
- **處理速度慢**：比對稱加密慢 100-1000 倍
- **計算資源需求高**：需要大量運算
- **金鑰長度較長**：通常需要 1024-4096 位元

**RSA 演算法詳解**

**數學基礎**：大數質因數分解的困難性

**金鑰生成步驟**
```
1. 選擇兩個大質數 p 和 q
   例：p = 61, q = 53

2. 計算 n = p × q
   n = 61 × 53 = 3233

3. 計算歐拉函數 φ(n) = (p-1) × (q-1)
   φ(n) = 60 × 52 = 3120

4. 選擇公鑰指數 e，滿足：
   - 1 < e < φ(n)
   - gcd(e, φ(n)) = 1
   例：e = 17

5. 計算私鑰指數 d，滿足：
   e × d ≡ 1 (mod φ(n))
   17 × d ≡ 1 (mod 3120)
   d = 2753

6. 公鑰：(n, e) = (3233, 17)
   私鑰：(n, d) = (3233, 2753)
```

**加密解密過程**
```
加密：C = M^e mod n
解密：M = C^d mod n

其中 M 為明文，C 為密文
```

**其他非對稱演算法**
- **ECC (Elliptic Curve Cryptography)**：橢圓曲線加密
- **DSA (Digital Signature Algorithm)**：數位簽章演算法
- **Diffie-Hellman**：金鑰交換協定

### 雜湊函數

**基本特性**
- **單向性**：無法從雜湊值反推原始資料
- **固定長度**：不論輸入長度，輸出長度固定
- **抗碰撞性**：難以找到兩個不同輸入產生相同輸出
- **雪崩效應**：輸入微小改變導致輸出大幅變化

**安全要求**
- **抗原像攻擊**：給定雜湊值，難以找到對應的原始訊息
- **抗第二原像攻擊**：給定訊息，難以找到另一個產生相同雜湊的訊息
- **抗碰撞攻擊**：難以找到任意兩個產生相同雜湊的訊息

**常見演算法比較**

| 演算法 | 輸出長度 | 安全性 | 狀態 | 應用 |
|--------|----------|--------|------|------|
| MD5 | 128 位元 | 低 | 已破解 | 僅用於校驗和 |
| SHA-1 | 160 位元 | 低 | 已破解 | 逐漸淘汰 |
| SHA-256 | 256 位元 | 高 | 安全 | 廣泛使用 |
| SHA-512 | 512 位元 | 高 | 安全 | 高安全需求 |
| SHA-3 | 可變 | 高 | 安全 | 新一代標準 |

**MD5 安全問題**
- **碰撞攻擊**：2004 年首次發現碰撞
- **彩虹表攻擊**：預計算的明文-雜湊對照表
- **暴力破解**：短密碼容易被破解
- **建議**：僅用於非安全性校驗，不可用於密碼儲存

**SHA 家族演進**
- **SHA-0**：1993 年，有缺陷，立即撤回
- **SHA-1**：1995 年，修正 SHA-0，2017 年正式被破解
- **SHA-2**：包含 SHA-224、SHA-256、SHA-384、SHA-512
- **SHA-3**：2015 年標準化，基於不同數學原理

### 混合加密系統

**概念**：結合對稱和非對稱加密的優點

**工作流程**
```
1. 產生隨機的對稱金鑰 (會話金鑰)
2. 用對稱金鑰加密大量資料
3. 用接收者的公鑰加密對稱金鑰
4. 傳送：加密的資料 + 加密的金鑰
5. 接收者用私鑰解密對稱金鑰
6. 用對稱金鑰解密實際資料
```

**優點**
- **高效能**：大量資料用對稱加密
- **安全性**：金鑰用非對稱加密保護
- **實用性**：結合兩種加密的優點

**應用**：HTTPS、PGP、S/MIME

---

## 數位簽章與 PKI
[⬆️ 回到目錄](#目錄)

### 數位簽章

**基本概念**
- **定義**：使用私鑰對資料進行數位簽署，他人可用公鑰驗證
- **目的**：確保訊息的完整性、真實性和不可否認性

**與加密的差異**
```
加密：用公鑰加密，私鑰解密 (保密性)
簽章：用私鑰簽署，公鑰驗證 (認證性)
```

**數位簽章流程**
```
1. 發送者對原始訊息計算雜湊值
2. 用發送者的私鑰對雜湊值進行簽署
3. 傳送：原始訊息 + 數位簽章
4. 接收者用發送者的公鑰驗證簽章
5. 對原始訊息重新計算雜湊值
6. 比較解密後的雜湊值與重新計算的雜湊值
```

**提供的安全特性**
- **完整性 (Integrity)**：確保訊息未被篡改
- **認證性 (Authentication)**：確認訊息來源
- **不可否認性 (Non-repudiation)**：發送者無法否認曾經發送

**實際應用**
- **電子郵件簽章**：S/MIME、PGP
- **軟體簽章**：確保軟體完整性
- **電子文件**：PDF 數位簽章
- **程式碼簽章**：驗證軟體發布者

### PKI 公開金鑰基礎建設

**PKI 組成要素**

**憑證授權中心 (Certificate Authority, CA)**
- **功能**：簽發和管理數位憑證
- **責任**：
  - 驗證申請者身份
  - 簽發數位憑證
  - 維護憑證撤銷清單 (CRL)
  - 管理憑證生命週期

**註冊授權中心 (Registration Authority, RA)**
- **功能**：協助 CA 進行身份驗證
- **職責**：
  - 接受憑證申請
  - 驗證申請者身份
  - 初始審核申請

**數位憑證 (Digital Certificate)**
- **標準**：X.509 v3
- **內容**：
  - 憑證持有者資訊
  - 公鑰
  - CA 的數位簽章
  - 有效期限
  - 憑證序號

**憑證撤銷清單 (Certificate Revocation List, CRL)**
- **用途**：列出已撤銷的憑證
- **撤銷原因**：
  - 私鑰洩露
  - CA 被破壞
  - 持有者資訊變更
  - 憑證誤發

**PKI 信任模式**

**階層式信任模式**
```
根 CA (Root CA)
├── 中介 CA 1
│   ├── 終端憑證 A
│   └── 終端憑證 B
└── 中介 CA 2
    ├── 終端憑證 C
    └── 終端憑證 D
```

**網狀信任模式**
- **概念**：CA 之間相互交叉認證
- **優點**：增加信任路徑
- **缺點**：管理複雜

**Web of Trust**
- **代表**：PGP/GnuPG
- **概念**：用戶之間相互簽署認證
- **優點**：去中心化
- **缺點**：信任關係複雜

### 憑證驗證過程

**憑證鏈驗證**
```
1. 檢查憑證格式和簽章
2. 驗證憑證有效期限
3. 檢查憑證撤銷狀態 (CRL/OCSP)
4. 驗證憑證鏈到信任的根 CA
5. 檢查憑證用途和約束
```

**線上憑證狀態協定 (OCSP)**
- **目的**：即時查詢憑證撤銷狀態
- **優點**：比 CRL 更即時
- **缺點**：需要網路連線

---

## 網路安全協定
[⬆️ 回到目錄](#目錄)

### SSL/TLS 協定

**協定演進**
- **SSL 1.0**：未公開發布
- **SSL 2.0**：1995年，有安全漏洞
- **SSL 3.0**：1996年，基礎版本
- **TLS 1.0**：1999年，SSL 3.0 改進版
- **TLS 1.1**：2006年，修正多項漏洞
- **TLS 1.2**：2008年，目前主流
- **TLS 1.3**：2018年，最新版本

**TLS 提供的安全服務**
- **機密性 (Confidentiality)**：對稱加密保護資料
- **完整性 (Integrity)**：MAC 或 AEAD 保護
- **認證性 (Authentication)**：數位憑證驗證身份

**TLS 握手過程 (TLS 1.2)**
```
客戶端                                    伺服器
  |                                         |
  |-------ClientHello-------------------->|
  |                                         |
  |<------ServerHello----------------------|
  |<------Certificate---------------------|
  |<------ServerKeyExchange (可選)---------|
  |<------CertificateRequest (可選)--------|
  |<------ServerHelloDone------------------|
  |                                         |
  |-------Certificate (可選)-------------->|
  |-------ClientKeyExchange--------------->|
  |-------CertificateVerify (可選)-------->|
  |-------ChangeCipherSpec---------------->|
  |-------Finished----------------------->|
  |                                         |
  |<------ChangeCipherSpec-----------------|
  |<------Finished-------------------------|
  |                                         |
  |        加密的應用資料傳輸               |
```

**TLS 1.3 改進**
- **簡化握手**：減少往返次數
- **移除弱加密**：禁用過時的加密演算法
- **前向安全性**：所有連線都有前向安全性
- **0-RTT 模式**：某些情況下可立即傳送資料

**HTTPS 實作**
- **埠號**：443
- **URL 前綴**：https://
- **瀏覽器指示**：鎖頭圖示、綠色位址列
- **憑證驗證**：自動驗證伺服器憑證

### SSH 協定

**基本特性**
- **埠號**：22
- **加密**：所有通訊都加密
- **認證**：多種認證方式
- **完整性**：防止資料被篡改

**SSH 協定架構**
```
SSH 連線協定 (SSH-CONN)
SSH 使用者認證協定 (SSH-USERAUTH)  
SSH 傳輸協定 (SSH-TRANS)
TCP/IP
```

**認證方式**
- **密碼認證**：傳統用戶名密碼
- **公鑰認證**：使用金鑰對
- **主機認證**：基於主機金鑰
- **鍵盤互動**：動態質詢應答

**SSH 金鑰認證流程**
```
1. 客戶端產生金鑰對 (公鑰/私鑰)
2. 將公鑰複製到伺服器 (~/.ssh/authorized_keys)
3. 連線時，伺服器發送隨機挑戰
4. 客戶端用私鑰簽署挑戰
5. 伺服器用公鑰驗證簽章
```

**SSH 隧道技術**
- **本地埠轉發**：將本地埠流量轉發到遠端
- **遠端埠轉發**：將遠端埠流量轉發到本地
- **動態埠轉發**：SOCKS 代理模式

**安全優點**
- **防止中間人攻擊**：主機金鑰驗證
- **防止密碼竊聽**：所有通訊加密
- **會話完整性**：防止會話劫持

### IPsec 協定

**架構概覽**
- **位置**：網路層 (Layer 3)
- **透明性**：應用程式無需修改
- **彈性**：可保護任何 IP 流量

**核心協定**

**AH (Authentication Header)**
- **功能**：
  - 資料完整性驗證
  - 來源認證
  - 防重播攻擊
- **不提供**：機密性 (不加密)
- **保護範圍**：整個 IP 封包 (除了可變欄位)

**ESP (Encapsulating Security Payload)**
- **功能**：
  - 資料機密性 (加密)
  - 資料完整性
  - 來源認證
  - 防重播攻擊
- **彈性**：可選擇僅加密或僅認證

**工作模式詳解**

**傳輸模式 (Transport Mode)**
```
原始 IP 封包：
[IP Header][TCP Header][Data]

AH 傳輸模式：
[IP Header][AH Header][TCP Header][Data]

ESP 傳輸模式：
[IP Header][ESP Header][Encrypted TCP Header + Data][ESP Trailer][ESP Auth]
```

- **用途**：端對端通訊
- **優點**：
  - 較低的額外負擔
  - 保持原始 IP 位址
  - 路由簡單
- **缺點**：
  - IP 標頭未受保護
  - 可能洩露流量模式

**隧道模式 (Tunnel Mode)**
```
原始 IP 封包：
[IP Header][TCP Header][Data]

AH 隧道模式：
[New IP Header][AH Header][Original IP Header][TCP Header][Data]

ESP 隧道模式：
[New IP Header][ESP Header][Encrypted Original IP + TCP + Data][ESP Trailer][ESP Auth]
```

- **用途**：VPN、閘道對閘道
- **優點**：
  - 隱藏原始 IP 位址
  - 完整的封包保護
  - 更高安全性
- **缺點**：
  - 較高的額外負擔
  - 可能的 MTU 問題

**金鑰管理**

**IKE (Internet Key Exchange)**
- **版本**：IKEv1、IKEv2
- **功能**：
  - 自動金鑰交換
  - 安全關聯 (SA) 建立
  - 身份認證

**手動金鑰配置**
- **適用**：小型、靜態環境
- **缺點**：
  - 不支援金鑰更新
  - 管理複雜
  - 缺乏完美前向安全性

### DNSSEC

**DNS 安全問題**
- **快取污染**：惡意回應污染 DNS 快取
- **中間人攻擊**：攔截並修改 DNS 回應
- **網域劫持**：重導向到惡意網站

**DNSSEC 解決方案**
- **數位簽章**：對 DNS 記錄進行簽章
- **信任鏈**：從根域建立信任鏈
- **資料完整性**：確保 DNS 回應未被篡改

**DNSSEC 記錄類型**
- **RRSIG**：資源記錄簽章
- **DNSKEY**：DNS 公鑰
- **DS**：委派簽章者
- **NSEC/NSEC3**：拒絕存在證明

**驗證流程**
```
1. 查詢 DNS 記錄
2. 同時取得對應的 RRSIG
3. 取得簽章金鑰 (DNSKEY)
4. 驗證簽章的有效性
5. 追溯信任鏈到根域
```

---

## 虛擬私人網路 (VPN)
[⬆️ 回到目錄](#目錄)

### VPN 基本概念

**定義與目的**
- **定義**：在公共網路上建立安全、加密的私人通訊隧道
- **核心目的**：
  - 保護資料傳輸安全
  - 隱藏真實 IP 位址
  - 突破地理限制
  - 安全存取企業內部資源

**VPN 的價值**
- **隱私保護**：加密所有網路流量
- **安全性**：防止資料被竊聽或篡改
- **匿名性**：隱藏用戶的真實位置
- **存取控制**：安全存取受限制的資源

### VPN 類型詳解

**Site-to-Site VPN (站對站 VPN)**

**使用場景**：
- 企業總部與分公司連接
- 不同辦公室之間的網路互連
- 企業合作夥伴之間的安全連接

**架構特性**：
```
總部 LAN ←→ [VPN 閘道] ←→ [網際網路] ←→ [VPN 閘道] ←→ 分公司 LAN
```

**優點**：
- 透明化：用戶無需額外操作
- 高效能：專用硬體處理
- 集中管理：IT 部門統一配置
- 成本效益：取代專線連接

**缺點**：
- 初期建置成本高
- 需要專業 IT 人員維護
- 單點故障風險

**Client-to-Site VPN (客戶端對站 VPN)**

**使用場景**：
- 遠端工作者存取公司資源
- 出差員工安全連接
- 在家工作 (WFH) 安全連線
- 移動設備安全存取

**架構特性**：
```
遠端用戶 ←→ [VPN 客戶端] ←→ [網際網路] ←→ [VPN 伺服器] ←→ 企業 LAN
```

**優點**：
- 彈性高：任何地點都可連接
- 個別控制：可針對用戶設定權限
- 成本低：軟體解決方案
- 即時存取：隨時連接企業資源

**缺點**：
- 需要客戶端軟體
- 效能取決於用戶的網路環境
- 管理較複雜

**Remote Access VPN (遠端存取 VPN)**

**使用場景**：
- 個人隱私保護
- 地理限制突破
- 公共 Wi-Fi 安全連接
- 避免 ISP 流量監控

### VPN 技術實作

**IPSec VPN 深入分析**

**工作層級**：網路層 (Layer 3)

**技術組合**：
- **ESP (Encapsulating Security Payload)**：提供加密和認證
- **隧道模式**：完整封包保護
- **IKE (Internet Key Exchange)**：自動金鑰管理

**IPSec VPN 建立過程**：
```
第一階段 (IKE Phase 1)：
1. 政策協商 (加密演算法、認證方式、DH 群組)
2. Diffie-Hellman 金鑰交換
3. 身份認證 (預共享金鑰或數位憑證)
4. 建立 IKE SA (安全關聯)

第二階段 (IKE Phase 2)：
1. IPSec 政策協商
2. 建立 IPSec SA
3. 開始加密資料傳輸
```

**IPSec VPN 優點**：
- **標準化**：IETF 標準，互操作性佳
- **安全性高**：強大的加密和認證
- **透明化**：應用程式無需修改
- **效能佳**：硬體加速支援

**IPSec VPN 缺點**：
- **設定複雜**：需要專業知識
- **防火牆穿透**：NAT 環境可能有問題
- **維護困難**：故障排除複雜

**SSL/TLS VPN 深入分析**

**工作層級**：應用層 (Layer 7)

**實作方式**：
- **SSL Portal**：透過網頁存取資源
- **SSL Tunnel**：建立完整的網路隧道
- **Application Proxy**：特定應用程式代理

**SSL VPN 建立過程**：
```
1. 用戶透過瀏覽器連接 VPN 閘道
2. TLS 握手過程 (憑證驗證、密鑰交換)
3. 用戶身份認證 (帳號密碼、數位憑證、2FA)
4. 建立 TLS 隧道
5. 開始安全的資料傳輸
```

**SSL VPN 優點**：
- **易於部署**：僅需瀏覽器，無需客戶端軟體
- **穿透能力強**：容易通過防火牆和 NAT
- **使用簡單**：用戶體驗佳
- **平台無關**：支援各種作業系統

**SSL VPN 缺點**：
- **效能較低**：應用層處理，效能不如 IPSec
- **功能限制**：部分網路功能可能不支援
- **安全性依賴**：依賴瀏覽器和 TLS 實作

### VPN 協定比較

| 特性 | IPSec VPN | SSL VPN | WireGuard | OpenVPN |
|------|-----------|---------|-----------|---------|
| 工作層級 | 網路層 | 應用層 | 網路層 | 應用層 |
| 設定複雜度 | 高 | 中 | 低 | 中 |
| 效能 | 高 | 中 | 極高 | 中 |
| 安全性 | 高 | 高 | 高 | 高 |
| NAT 穿透 | 困難 | 容易 | 容易 | 容易 |
| 客戶端需求 | 內建支援 | 瀏覽器 | 專用客戶端 | 專用客戶端 |
| 管理複雜度 | 高 | 中 | 低 | 中 |

### VPN 安全考量

**加密強度**
- **對稱加密**：AES-256 為當前標準
- **非對稱加密**：RSA-2048 或 ECC-256
- **雜湊演算法**：SHA-256 或更強
- **完美前向安全性 (PFS)**：確保會話金鑰的安全

**認證機制**
- **預共享金鑰 (PSK)**：簡單但管理困難
- **數位憑證**：PKI 基礎，安全性高
- **多重認證**：結合多種認證方式

**VPN 洩漏防護**
- **DNS 洩漏**：確保 DNS 查詢也通過 VPN
- **WebRTC 洩漏**：瀏覽器可能洩露真實 IP
- **IPv6 洩漏**：確保 IPv6 流量也受保護
- **Kill Switch**：VPN 斷線時切斷網路連接

### 企業 VPN 部署

**設計考量**
- **使用者數量**：同時連線用戶數量
- **頻寬需求**：總體頻寬和個別用戶頻寬
- **地理分佈**：多地點部署考量
- **高可用性**：冗餘和故障轉移

**存取控制**
- **基於角色的存取控制 (RBAC)**
- **網路分割**：限制存取範圍
- **時間限制**：特定時間允許存取
- **設備認證**：確保設備合規性

**監控與稽核**
- **連線記錄**：誰、何時、從哪裡連接
- **流量監控**：監控異常流量模式
- **安全事件**：記錄安全相關事件
- **合規報告**：滿足法規要求

---

## 常見網路攻擊
[⬆️ 回到目錄](#目錄)

### 密碼攻擊

**暴力攻擊 (Brute Force Attack)**
- **方法**：系統性嘗試所有可能的密碼組合
- **計算**：
  ```
  密碼空間 = 字符集大小^密碼長度
  
  例：8位英數字密碼
  字符集：a-z, A-Z, 0-9 (62個字符)
  可能組合：62^8 = 218,340,105,584,896
  ```
- **防禦**：
  - 使用長且複雜的密碼
  - 實施帳戶鎖定機制
  - 限制登入嘗試次數
  - 使用 CAPTCHA

**字典攻擊 (Dictionary Attack)**
- **方法**：使用常見密碼字典進行嘗試
- **字典來源**：
  - 常見密碼列表
  - 洩露的密碼資料庫
  - 特定語言常用詞彙
  - 個人資訊相關詞彙
- **改進版本**：
  - 規則型字典攻擊 (添加數字、符號)
  - 混合攻擊 (字典 + 暴力)
- **防禦**：
  - 避免使用常見密碼
  - 密碼複雜度要求
  - 密碼黑名單檢查

**彩虹表攻擊 (Rainbow Table Attack)**
- **原理**：預先計算的明文-雜湊對照表
- **空間時間權衡**：用儲存空間換取計算時間
- **建構方式**：
  ```
  明文 → Hash → Reduction → 明文 → Hash → ...
  ```
- **防禦**：
  - 使用加鹽 (Salt) 雜湊
  - 選擇強雜湊演算法
  - 定期更換密碼

**認證繞過攻擊**
- **SQL 注入繞過**：利用 SQL 注入繞過登入
- **會話劫持**：竊取有效的會話識別碼
- **記憶體攻擊**：從記憶體中提取密碼
- **旁道攻擊**：分析系統的物理特徵

### 網路層攻擊

**IP 欺騙 (IP Spoofing)**
- **目的**：偽造封包來源 IP 位址
- **類型**：
  - **盲目欺騙**：無法看到回應
  - **非盲目欺騙**：可以監控回應
- **攻擊場景**：
  - DoS/DDoS 攻擊
  - 繞過 IP 基礎的存取控制
  - 中間人攻擊
- **防禦**：
  - 入口過濾 (Ingress Filtering)
  - 出口過濾 (Egress Filtering)
  - 使用加密和認證

**ARP 欺騙 (ARP Spoofing)**
- **原理**：偽造 ARP 回應，重導向流量
- **攻擊流程**：
  ```
  1. 攻擊者監聽網路上的 ARP 請求
  2. 搶先發送偽造的 ARP 回應
  3. 受害者更新 ARP 表，指向攻擊者
  4. 流量重導向到攻擊者
  ```
- **影響**：
  - 中間人攻擊
  - 拒絕服務
  - 資料竊取
- **防禦**：
  - 靜態 ARP 項目
  - ARP 監控工具
  - 交換器的 ARP 檢查
  - 使用加密通訊

**ICMP 攻擊**
- **Ping of Death**：發送超大 ICMP 封包
- **ICMP Flood**：大量 ICMP 封包造成資源耗盡
- **ICMP Redirect**：重導向路由
- **防禦**：
  - 限制 ICMP 流量
  - 過濾特定 ICMP 類型
  - 網路設備更新

### 拒絕服務攻擊

**DoS (Denial of Service) 攻擊**

**SYN Flood 攻擊**
- **原理**：利用 TCP 三向握手的缺陷
- **攻擊流程**：
  ```
  1. 攻擊者發送大量 SYN 封包
  2. 使用偽造的來源 IP
  3. 伺服器回應 SYN-ACK 並等待 ACK
  4. ACK 永遠不會到達
  5. 伺服器連線表滿了，無法處理新連線
  ```
- **防禦**：
  - SYN Cookies 技術
  - 增加連線表大小
  - 設定合理的超時時間
  - 使用防火牆過濾

**UDP Flood 攻擊**
- **原理**：發送大量 UDP 封包消耗資源
- **特點**：
  - UDP 無連線特性
  - 難以追蹤攻擊來源
  - 容易偽造來源 IP
- **防禦**：
  - 限制 UDP 流量
  - 過濾無效的 UDP 封包
  - 使用入侵偵測系統

**DDoS (Distributed Denial of Service) 攻擊**

**攻擊架構**：
```
攻擊者 (Command & Control)
    ↓
僵尸網路 (Botnet)
├── 感染主機 1
├── 感染主機 2  
├── 感染主機 3
└── ... (數千到數萬台)
    ↓
目標伺服器
```

**放大攻擊**
- **DNS 放大**：
  ```
  小查詢 (60 bytes) → 大回應 (4000 bytes)
  放大倍率：約 70 倍
  ```
- **NTP 放大**：利用 NTP 的 monlist 指令
- **SNMP 放大**：利用 SNMP 的 GetBulk 請求

**DDoS 防禦**：
- **流量清洗**：過濾惡意流量
- **內容分發網路 (CDN)**：分散流量
- **彈性擴展**：雲端資源自動擴展
- **DDoS 防護服務**：專業防護提供商

### 中間人攻擊

**攻擊類型**

**網路層中間人**
- **ARP 欺騙**：重導向區域網路流量
- **路由攻擊**：劫持路由通告
- **DNS 劫持**：重導向 DNS 解析

**應用層中間人**
- **SSL 剝離**：降級 HTTPS 連線到 HTTP
- **惡意 Wi-Fi 熱點**：架設假的 Wi-Fi 存取點
- **代理伺服器攻擊**：惡意代理攔截流量

**防禦措施**
- **加密通訊**：使用 HTTPS、VPN
- **憑證驗證**：檢查伺服器憑證
- **HSTS (HTTP Strict Transport Security)**：強制 HTTPS
- **憑證綁定 (Certificate Pinning)**：預先綁定憑證

### 會話攻擊

**會話劫持 (Session Hijacking)**
- **方法**：
  - 網路竊聽取得會話 ID
  - XSS 攻擊竊取 Cookie
  - 中間人攻擊攔截會話
- **防禦**：
  - 使用 HTTPS 加密
  - 安全的會話管理
  - 定期更新會話 ID
  - 會話逾時機制

**重播攻擊 (Replay Attack)**
- **原理**：重複發送先前截獲的有效訊息
- **應用場景**：
  - 認證系統攻擊
  - 金融交易重複
  - 指令重複執行
- **防禦**：
  - 時間戳記檢查
  - 隨機數 (Nonce) 機制
  - 序號檢查
  - 會話金鑰

### 進階持續威脅 (APT)

**APT 特徵**
- **持續性**：長時間潛伏在系統中
- **隱蔽性**：避免被偵測
- **目標性**：針對特定組織或個人
- **多階段**：複雜的攻擊鏈

**APT 攻擊鏈**
```
1. 偵察 (Reconnaissance)
2. 武器化 (Weaponization)  
3. 投遞 (Delivery)
4. 利用 (Exploitation)
5. 安裝 (Installation)
6. 指揮控制 (Command & Control)
7. 目標達成 (Actions on Objectives)
```

**防禦策略**
- **多層防護**：defence in depth
- **威脅狩獵**：主動尋找威脅
- **行為分析**：偵測異常行為
- **威脅情報**：了解最新威脅

---

## Web 應用程式安全
[⬆️ 回到目錄](#目錄)

### SQL 注入攻擊 (SQL Injection)

**什麼是 SQL 注入？**

SQL 注入是一種網頁應用程式的安全漏洞，攻擊者在輸入欄位中插入惡意的 SQL 程式碼，讓資料庫執行非預期的操作。

**簡單範例**：
```sql
-- 正常的登入查詢
SELECT * FROM users WHERE username = 'admin' AND password = 'mypassword'

-- 如果使用者在帳號欄位輸入：admin'--
-- 實際執行的 SQL 變成：
SELECT * FROM users WHERE username = 'admin'--' AND password = 'mypassword'

-- 結果：密碼檢查被註解掉，攻擊者成功登入
```

**為什麼會發生？**
- 程式直接將使用者輸入串接到 SQL 查詢中
- 沒有對輸入進行適當的驗證和過濾
- 缺乏使用安全的程式設計方法

**可能造成的危害**
- **資料洩露**：竊取帳號密碼、個人資料
- **資料破壞**：刪除或修改重要資料
- **權限提升**：獲得管理員權限
- **系統控制**：在嚴重情況下控制整個系統

**SQL 注入防護方法**

**1. 使用參數化查詢 (最重要)**
```php
// ❌ 錯誤寫法 (危險)
$query = "SELECT * FROM users WHERE username = '$username' AND password = '$password'";

// ✅ 正確寫法 (安全)
$stmt = $pdo->prepare("SELECT * FROM users WHERE username = ? AND password = ?");
$stmt->execute([$username, $password]);
```

```java
// ✅ Java 安全寫法
String sql = "SELECT * FROM users WHERE username = ? AND password = ?";
PreparedStatement stmt = connection.prepareStatement(sql);
stmt.setString(1, username);
stmt.setString(2, password);
```

**2. 使用 ORM 框架**
```python
# ✅ Django ORM (安全)
users = User.objects.filter(username=username, password=password)

# ❌ 錯誤用法 (不安全)
users = User.objects.extra(where=["username = '%s'" % username])
```

**3. 輸入驗證**
```php
// 白名單驗證
function validateInput($input, $type) {
    switch($type) {
        case 'username':
            return preg_match('/^[a-zA-Z0-9_]{3,20}$/', $input);
        case 'email':
            return filter_var($input, FILTER_VALIDATE_EMAIL);
        case 'number':
            return is_numeric($input);
        default:
            return false;
    }
}
```

**4. 資料庫權限控制**
- **最小權限原則**：應用程式只能存取必要的資料表
- **禁用危險權限**：不給予 DROP、CREATE、ALTER 等權限
- **使用專用帳號**：為應用程式建立專用的資料庫使用者

**5. 錯誤處理**
```php
// ❌ 錯誤範例 (會洩露資料庫資訊)
if(!$result) {
    die('Error: ' . mysql_error());
}

// ✅ 正確範例 (隱藏錯誤詳情)
if(!$result) {
    error_log('Database error: ' . mysql_error());
    die('系統發生錯誤，請稍後再試。');
}
```

**6. 使用 Web 應用程式防火牆 (WAF)**
- 自動偵測和阻擋 SQL 注入攻擊
- 過濾惡意請求
- 記錄攻擊嘗試

**防護重點總結**
1. **永遠使用參數化查詢** - 這是最有效的防護方法
2. **驗證所有使用者輸入** - 白名單驗證優於黑名單
3. **遵循最小權限原則** - 限制資料庫存取權限
4. **隱藏錯誤訊息** - 不要洩露系統詳細資訊
5. **定期安全測試** - 使用工具檢測潛在漏洞

**記住**：預防 SQL 注入的關鍵是「永遠不要信任使用者輸入」，並使用安全的程式設計方法來處理資料庫查詢。

### 跨站腳本攻擊 (XSS)

**XSS 攻擊類型**

**1. 反射型 XSS (Reflected XSS)**
- **特性**：惡意腳本通過 URL 參數傳入
- **攻擊流程**：
  ```
  1. 攻擊者構造惡意 URL
  2. 誘騙受害者點擊
  3. 伺服器將輸入直接回傳到頁面
  4. 惡意腳本在受害者瀏覽器執行
  ```

**2. 儲存型 XSS (Stored XSS)**
- **特性**：惡意腳本儲存在伺服器
- **危險性**：影響所有訪問該頁面的用戶
- **常見位置**：留言板、論壇、個人資料

**3. DOM型 XSS (DOM-based XSS)**
- **特性**：完全在客戶端執行
- **原因**：JavaScript 不當處理 DOM

**XSS 防禦**
- **輸出編碼**：HTML、JavaScript、CSS 編碼
- **Content Security Policy (CSP)**：限制腳本來源
- **輸入驗證**：過濾危險字符
- **HttpOnly Cookie**：防止腳本存取 Cookie

### 跨站請求偽造 (CSRF)

**CSRF 攻擊原理**
- 利用受害者的已認證會話
- 誘騙受害者執行非預期的動作
- 攻擊者無法看到回應內容

**防禦措施**
- **CSRF Token**：隨機的不可預測值
- **SameSite Cookie**：限制跨站請求
- **驗證 Referer**：檢查請求來源
- **雙重驗證**：重要操作需要額外確認

---

## 系統安全威脅
[⬆️ 回到目錄](#目錄)

### 惡意軟體分類

**電腦病毒 (Virus)**
- **特性**：
  - 需要宿主檔案才能執行
  - 具有自我複製能力
  - 需要使用者執行感染檔案
  - 可以感染可執行檔案、文件、開機磁區

**感染方式**：
- **檔案感染型**：感染 .exe、.com 檔案
- **巨集病毒**：感染 Office 文件
- **開機病毒**：感染主開機記錄 (MBR)
- **多形病毒**：變化自身程式碼避免偵測

**電腦蠕蟲 (Worm)**
- **特性**：
  - 完全獨立，不需要宿主
  - 主動透過網路傳播
  - 自動複製和傳播
  - 消耗網路頻寬和系統資源

**傳播方式**：
- **電子郵件**：通過郵件附件
- **網路共享**：利用網路共享資料夾
- **漏洞利用**：攻擊系統漏洞
- **可移除媒體**：USB、光碟等

**木馬程式 (Trojan Horse)**
- **特性**：
  - 偽裝成合法軟體
  - 不具自我複製能力
  - 通常有後門功能
  - 需要使用者主動安裝

**常見類型**：
- **遠端存取木馬 (RAT)**：遠端控制受害電腦
- **銀行木馬**：竊取金融資訊
- **下載器**：下載其他惡意軟體
- **假防毒軟體**：偽裝成安全軟體

**隱匿軟體 (Rootkit)**
- **目的**：隱藏其他惡意軟體的存在
- **工作層級**：
  - **應用層 Rootkit**：修改應用程式
  - **核心層 Rootkit**：修改作業系統核心
  - **韌體 Rootkit**：感染系統韌體
  - **虛擬機器 Rootkit**：在虛擬機器層運行

**隱藏技術**：
- **程序隱藏**：在工作管理員中隱藏
- **檔案隱藏**：隱藏檔案和資料夾
- **網路連線隱藏**：隱藏網路活動
- **登錄項隱藏**：隱藏系統登錄項目

### 進階威脅

**間諜軟體 (Spyware)**
- **資料收集**：
  - 按鍵記錄 (Keylogger)
  - 螢幕截圖
  - 網頁瀏覽紀錄
  - 個人檔案
  - 系統資訊

**勒索病毒 (Ransomware)**
- **攻擊流程**：
  ```
  1. 初始感染 (郵件附件、漏洞利用)
  2. 系統探索 (尋找重要檔案)
  3. 檔案加密 (使用強加密演算法)
  4. 勒索訊息 (要求贖金)
  5. 支付驗證 (通常要求比特幣)
  ```

**防護策略**：
- **定期備份**：多版本、離線備份
- **系統更新**：修補安全漏洞
- **端點保護**：進階防毒軟體
- **網路分割**：限制橫向移動
- **員工教育**：識別釣魚郵件

### 緩衝區溢位攻擊

**攻擊原理**
- 程式分配固定大小的記憶體緩衝區
- 輸入資料超出緩衝區大小
- 覆蓋相鄰的記憶體區域
- 可能改變程式執行流程

**堆疊溢位 (Stack Overflow)**
```c
// 脆弱的程式碼範例
void vulnerable_function(char *input) {
    char buffer[100];
    strcpy(buffer, input);  // 危險：不檢查長度
}

// 攻擊者可以覆蓋返回地址
// 控制程式執行流程
```

**堆積溢位 (Heap Overflow)**
- 發生在動態分配的記憶體中
- 主要攻擊記憶體管理結構
- 可能導致任意程式碼執行

**防護措施**
- **使用安全函數**：
  ```c
  // 不安全
  strcpy(dest, src);
  
  // 安全
  strncpy(dest, src, sizeof(dest)-1);
  dest[sizeof(dest)-1] = '\0';
  ```
- **編譯器保護**：
  - Stack Canary：偵測堆疊溢位
  - ASLR：隨機化記憶體配置
  - DEP/NX：資料執行防護
- **程式碼審查**：人工或自動檢查
- **模糊測試**：自動化測試工具

---

## 網路防護機制
[⬆️ 回到目錄](#目錄)

### 防火牆技術

**防火牆基本概念**
- **定義**：控制網路流量進出的安全設備
- **位置**：內部網路與外部網路之間
- **功能**：檢查、過濾、記錄網路封包

**防火牆類型**

**1. 封包過濾防火牆 (Packet Filtering)**
- **工作層級**：網路層和傳輸層
- **檢查內容**：
  - 來源/目的 IP 位址
  - 來源/目的埠號
  - 協定類型 (TCP/UDP/ICMP)
  - 封包方向 (進/出)

**優點**：
- 處理速度快
- 透明化操作
- 成本較低

**缺點**：
- 無法檢查應用層內容
- 容易被偽造攻擊
- 難以處理動態埠號

**2. 狀態檢查防火牆 (Stateful Inspection)**
- **工作原理**：追蹤連線狀態
- **狀態表**：記錄活躍連線資訊
- **連線追蹤**：
  ```
  TCP 連線狀態：
  NEW → ESTABLISHED → CLOSING → CLOSED
  
  只允許已建立連線的回應封包通過
  ```

**3. 應用層防火牆 (Application Layer Firewall)**
- **功能**：深度封包檢查 (DPI)
- **檢查內容**：
  - 應用層協定內容
  - 使用者身份
  - 應用程式行為
- **代理型防火牆**：作為客戶端和伺服器的中介

**防火牆規則設計**

**基本原則**：
- **最小權限原則**：僅允許必要的流量
- **預設拒絕**：未明確允許的流量一律拒絕
- **規則順序**：從上到下依序檢查

**規則範例**：
```
1. ALLOW TCP 192.168.1.0/24 → ANY:80 (HTTP)
2. ALLOW TCP 192.168.1.0/24 → ANY:443 (HTTPS)  
3. ALLOW TCP 192.168.1.100 → 10.0.0.50:22 (SSH)
4. DENY TCP ANY → 192.168.1.0/24:22 (拒絕外部SSH)
5. ALLOW ICMP 192.168.1.0/24 → ANY (Ping)
6. DENY ALL (預設拒絕)
```

### 入侵偵測與防護

**入侵偵測系統 (IDS)**
- **功能**：監控和偵測惡意活動
- **回應方式**：警告管理員，不主動阻擋

**入侵防護系統 (IPS)**
- **功能**：偵測並主動阻擋攻擊
- **部署方式**：串聯在網路路徑上

**偵測方法**

**1. 簽章偵測 (Signature-based Detection)**
- **原理**：比對已知攻擊模式
- **優點**：誤報率低、精確度高
- **缺點**：無法偵測未知攻擊

**2. 異常偵測 (Anomaly-based Detection)**
- **原理**：建立正常行為基準線
- **方法**：
  - 統計分析
  - 機器學習
  - 行為分析
- **優點**：可偵測未知攻擊
- **缺點**：誤報率較高

**3. 混合偵測**
- 結合簽章和異常偵測
- 提高偵測率和準確度

### 端點防護

**傳統防毒軟體**
- **簽章偵測**：比對病毒特徵碼
- **啟發式偵測**：分析可疑行為
- **即時保護**：監控檔案存取

**新一代端點防護 (EPP/EDR)**
- **行為分析**：監控程序行為
- **機器學習**：AI 輔助偵測
- **威脅狩獵**：主動尋找威脅
- **事件回應**：快速隔離和修復

### 網路分割

**微分割 (Micro-segmentation)**
- **概念**：細粒度的網路分割
- **實作**：軟體定義網路 (SDN)
- **優點**：
  - 限制橫向移動
  - 減少攻擊面
  - 提高可視性

**零信任架構 (Zero Trust)**
- **原則**：「永不信任，始終驗證」
- **核心概念**：
  - 最小權限存取
  - 持續驗證
  - 加密所有通訊
  - 微分割網路

---